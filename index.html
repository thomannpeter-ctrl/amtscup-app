<!doctype html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Amtscup â€“ Cup-Duell (bis zu drei Gruppen)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
*{box-sizing:border-box}
body{font-family:system-ui;background:#eef2f7;margin:0;color:#111827}
.container{max-width:1100px;margin:auto;padding:1rem}
h1{color:#1e3a8a}
h2{color:#1d4ed8}
.card{background:#fff;border-radius:12px;padding:1rem;margin-bottom:1rem;box-shadow:0 4px 10px rgba(0,0,0,.08)}
.row{display:flex;flex-wrap:wrap;gap:.75rem}
.field{flex:1 1 220px;display:flex;flex-direction:column}
input,select{padding:.45rem;border-radius:8px;border:1px solid #cbd5f5}
table{width:100%;border-collapse:collapse;font-size:.85rem}
th,td{border:1px solid #e5e7eb;padding:.35rem;text-align:center}
th{background:#dbeafe}
.zuschlag-cell,.total-cell,.sum-cell{background:#f3f4f6;font-weight:600}
button{border:none;border-radius:999px;padding:.45rem .95rem;cursor:pointer}
.btn-primary{background:#2563eb;color:#fff}
.btn-secondary{background:#e5e7eb}
.winner-box{margin-top:.5rem;padding:.6rem;border-radius:999px;font-weight:600}
.winner-none{background:#e5e7eb}
.winner-g1{background:#dcfce7}
.winner-g2{background:#dbeafe}
.winner-g3{background:#fee2e2}
.winner-draw{background:#fef9c3}
.error{border-color:#dc2626!important;background:#fee2e2!important}
</style>
</head>

<body>
<div class="container">
<h1>Amtscup â€“ Cup-Duell</h1>

<div class="card">
<div class="row">
<div class="field"><input id="chefName" placeholder="Gruppenchef Name"></div>
<div class="field"><input id="chefEmail" placeholder="E-Mail"></div>
</div>
<div class="row">
<div class="field"><input id="gruppe1Other" placeholder="Gruppe 1"></div>
<div class="field"><input id="gruppe2Other" placeholder="Gruppe 2"></div>
<div class="field"><input id="gruppe3Other" placeholder="Gruppe 3 (optional)"></div>
</div>
</div>

<div class="card">
<table>
<thead><tr><th>Name</th><th>Resultat</th></tr></thead>
<tbody id="shootersBody1">
<tr><td><input></td><td><input type="number"></td></tr>
<tr><td><input></td><td><input type="number"></td></tr>
<tr><td><input></td><td><input type="number"></td></tr>
<tr><td><input></td><td><input type="number"></td></tr>
<tr><td><input></td><td><input type="number"></td></tr>
</tbody>
</table>
</div>

<div class="card">
<button class="btn-primary" onclick="buildEmailAndSend()">ðŸ“§ Absenden</button>
</div>
</div>

<script>
const RESULT_EMAIL="thomannpeter@bluewin.ch"
const GOOGLE_SHEETS_URL="https://script.google.com/macros/s/AKfycbyzYZlUCpIiHsB_5a4gWyXM0SnrwPR_bMg_ke2AdOFkrLvOc2qsa5pCmbk6EWQjD-w7mw/exec"

function buildEmailAndSend(){
const chefName=chefNameInput.value
const chefEmail=chefEmailInput.value
const group1Name=gruppe1Other.value
const group2Name=gruppe2Other.value
const group3Name=gruppe3Other.value

let shooters=[]
let total=0
document.querySelectorAll("#shootersBody1 tr").forEach((r,i)=>{
const name=r.children[0].firstChild.value
const res=parseInt(r.children[1].firstChild.value||0)
if(name||res){
shooters.push({nr:i+1,name,result:res})
total+=res
}
})

const winnerText=group1Name+" ("+total+")"

fetch(GOOGLE_SHEETS_URL,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
chefName,
chefEmail,
group1Name,
group2Name,
group3Name,
shooters,
totals:{total},
winnerText,
sentAt:new Date().toISOString()
})
})

const body=
"Gruppenchef: "+chefName+"\n"+
"E-Mail: "+chefEmail+"\n"+
"Gruppe 1: "+group1Name+"\n"+
"Total: "+total+"\n"+
"Sieger: "+winnerText

window.location.href=
"mailto:"+RESULT_EMAIL+
"?subject="+encodeURIComponent("Amtscup Cup-Duell â€“ "+group1Name)+
"&body="+encodeURIComponent(body)
}

const chefNameInput=document.getElementById("chefName")
const chefEmailInput=document.getElementById("chefEmail")
const gruppe1Other=document.getElementById("gruppe1Other")
const gruppe2Other=document.getElementById("gruppe2Other")
const gruppe3Other=document.getElementById("gruppe3Other")
</script>

</body>
</html>
