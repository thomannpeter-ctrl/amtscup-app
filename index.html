<!doctype html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Amtscup â€“ Cup-Duell</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{font-family:system-ui;background:#eef2f7;margin:0}
.container{max-width:1100px;margin:auto;padding:1rem}
h1{color:#1e3a8a}
.card{background:#fff;border-radius:12px;padding:1rem;margin-bottom:1rem;box-shadow:0 4px 10px rgba(0,0,0,.08)}
.row{display:flex;gap:.75rem;flex-wrap:wrap}
.field{flex:1;min-width:200px}
label{font-size:.8rem;font-weight:600}
input,select,textarea{width:100%;padding:.45rem;border-radius:8px;border:1px solid #cbd5f5}
table{width:100%;border-collapse:collapse;font-size:.85rem}
th,td{border:1px solid #e5e7eb;padding:.35rem;text-align:center}
th{background:#dbeafe}
.sum-cell{background:#f3f4f6;font-weight:700}
button{border:none;border-radius:999px;padding:.45rem .9rem;cursor:pointer}
.btn-primary{background:#2563eb;color:#fff}
.btn-secondary{background:#e5e7eb}
.winner-box{margin-top:.5rem;padding:.6rem;border-radius:999px;font-weight:700}
.winner-none{background:#e5e7eb}
.winner-g1{background:#dcfce7}
.winner-g2{background:#dbeafe}
.preview-img{max-width:200px;display:none;margin-top:.5rem;border-radius:8px}
</style>
</head>

<body>
<div class="container">

<h1>Amtscup â€“ Cup-Duell</h1>

<div class="card">
<h2>Bild / PDF hochladen (optional)</h2>
<input id="fileUpload" type="file" accept="image/*,.pdf">
<img id="imagePreview" class="preview-img">
</div>

<div class="card">
<h2>Admin: Gruppen / Vereine</h2>

<div id="adminLocked">
<label>Admin-Passwort</label>
<input id="adminPassword" type="password">
<button id="adminLoginBtn" class="btn-primary">Admin Ã¶ffnen</button>
</div>

<div id="adminArea" style="display:none">
<textarea id="groupsText" rows="6"></textarea>
<button id="saveGroupsBtn" class="btn-primary">Speichern</button>
</div>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<script>
const RESULT_EMAIL="thomannpeter@bluewin.ch";

/* ðŸ”’ SHA-256 Hash von: Leona/3006/2021 */
const ADMIN_PASSWORD_HASH=
"7b0e3e0b3bbad52f1b7c7f9c2b6f9b1f6f3cb91f2f4b8e8a9b6b1c4f2b1a9c2e";

/* ---------- Passwort Hash ---------- */
async function hashPassword(text){
 const enc=new TextEncoder().encode(text);
 const buf=await crypto.subtle.digest("SHA-256",enc);
 return Array.from(new Uint8Array(buf))
 .map(b=>b.toString(16).padStart(2,"0")).join("");
}

/* ---------- Admin Login ---------- */
document.getElementById("adminLoginBtn").addEventListener("click",async()=>{
 const val=document.getElementById("adminPassword").value;
 const hash=await hashPassword(val);
 if(hash===ADMIN_PASSWORD_HASH){
  document.getElementById("adminLocked").style.display="none";
  document.getElementById("adminArea").style.display="block";
 }else{
  alert("Falsches Passwort");
 }
});

/* ---------- Upload Bild / PDF ---------- */
const fileInput=document.getElementById("fileUpload");
const preview=document.getElementById("imagePreview");

fileInput.addEventListener("change",()=>{
 const file=fileInput.files[0];
 if(!file){preview.style.display="none";return;}

 if(file.type.startsWith("image/")){
  const r=new FileReader();
  r.onload=e=>{
   preview.src=e.target.result;
   preview.style.display="block";
  };
  r.readAsDataURL(file);
 }else{
  preview.style.display="none";
  alert("PDF ausgewÃ¤hlt: "+file.name+"\nBitte im Mailprogramm manuell anhÃ¤ngen.");
 }
});
</script>

</body>
</html>
