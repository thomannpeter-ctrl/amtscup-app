<!doctype html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Amtscup – Cup-Duell</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:system-ui;background:#eef2f7;margin:0}
.container{max-width:1100px;margin:auto;padding:1rem}
.card{background:#fff;border-radius:12px;padding:1rem;margin-bottom:1rem;box-shadow:0 4px 10px rgba(0,0,0,.1)}
input,select{width:100%;padding:.4rem;border-radius:6px;border:1px solid #cbd5f5}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #e5e7eb;padding:.3rem;text-align:center}
button{padding:.5rem 1rem;border:none;border-radius:999px;cursor:pointer}
.btn-primary{background:#2563eb;color:#fff}
</style>
</head>

<body>
<div class="container">

<div class="card">
<input id="chefName" placeholder="Gruppenchef Name">
<input id="chefEmail" placeholder="E-Mail">
<input id="gruppe1Other" placeholder="Gruppe 1">
<input id="gruppe2Other" placeholder="Gruppe 2">
<input id="gruppe3Other" placeholder="Gruppe 3 (optional)">
</div>

<div class="card">
<table>
<thead>
<tr><th>Name</th><th>Resultat</th></tr>
</thead>
<tbody id="shootersBody1">
<tr><td><input></td><td><input type="number"></td></tr>
<tr><td><input></td><td><input type="number"></td></tr>
</tbody>
</table>
</div>

<div class="card">
<button class="btn-primary" onclick="buildEmailAndSend()">Absenden</button>
</div>

</div>

<script>
const RESULT_EMAIL="thomannpeter@bluewin.ch"
const GOOGLE_SHEETS_URL="https://script.google.com/macros/s/AKfycbyzYZlUCpIiHsB_5a4gWyXM0SnrwPR_bMg_ke2AdOFkrLvOc2qsa5pCmbk6EWQjD-w7mw/exec"

function buildEmailAndSend(){
const chefName=document.getElementById("chefName").value
const chefEmail=document.getElementById("chefEmail").value
const group1Name=document.getElementById("gruppe1Other").value
const group2Name=document.getElementById("gruppe2Other").value
const group3Name=document.getElementById("gruppe3Other").value

let total1=0
document.querySelectorAll("#shootersBody1 tr").forEach(r=>{
const v=parseInt(r.children[1].firstChild.value||0)
total1+=v
})

const winnerText=group1Name+" ("+total1+")"

const payload={
chefName,
chefEmail,
group1Name,
group2Name,
group3Name,
totals:{t1:{sumTotal:total1},t2:{sumTotal:0},t3:{sumTotal:0}},
winnerText
}

fetch(GOOGLE_SHEETS_URL,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify(payload)
})

const subject="Amtscup Cup-Duell – "+group1Name
const body=
"Gruppenchef: "+chefName+"\n"+
"E-Mail: "+chefEmail+"\n"+
"Gruppe 1: "+group1Name+"\n"+
"Total: "+total1+"\n"+
"Sieger: "+winnerText

window.location.href=
"mailto:"+RESULT_EMAIL+
"?subject="+encodeURIComponent(subject)+
"&body="+encodeURIComponent(body)
}
</script>

</body>
</html>
