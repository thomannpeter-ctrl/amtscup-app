<!doctype html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Amtscup ‚Äì Cup-Duell</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f4f6f8;margin:0;padding:0}
.container{max-width:1100px;margin:auto;padding:16px}
.card{background:#fff;border-radius:10px;padding:16px;margin-bottom:16px;box-shadow:0 2px 8px rgba(0,0,0,.08)}
h1,h2{margin-top:0;color:#1e3a8a}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{border:1px solid #ddd;padding:6px;text-align:center}
th{background:#e0ecff}
input,select{width:100%;padding:4px}
.sum{font-weight:bold;background:#f1f5f9}
button{padding:8px 14px;border-radius:20px;border:0;background:#2563eb;color:#fff;cursor:pointer}
.small{font-size:12px;color:#555}
</style>
</head>

<body>
<div class="container">
<h1>Amtscup ‚Äì Cup-Duell</h1>

<div class="card">
<h2>Paarung</h2>
<label>Gruppe 1 *</label>
<input id="g1">
<label>Gruppe 2 (optional)</label>
<input id="g2">
<label>Gruppe 3 (optional)</label>
<input id="g3">
</div>

<div class="card">
<h2>Sch√ºtzen ‚Äì Gruppe 1</h2>
<table>
<tr>
<th>#</th><th>Name*</th><th>Jahrgang*</th><th>Sportger√§t*</th><th>Resultat*</th>
</tr>
<tbody id="s1"></tbody>
<tr class="sum"><td colspan="4">Summe</td><td id="sum1">0</td></tr>
</table>
</div>

<div class="card">
<h2>Sch√ºtzen ‚Äì Gruppe 2</h2>
<table>
<tr>
<th>#</th><th>Name</th><th>Jahrgang</th><th>Sportger√§t</th><th>Resultat</th>
</tr>
<tbody id="s2"></tbody>
<tr class="sum"><td colspan="4">Summe</td><td id="sum2">0</td></tr>
</table>
</div>

<div class="card">
<h2>Sch√ºtzen ‚Äì Gruppe 3</h2>
<table>
<tr>
<th>#</th><th>Name</th><th>Jahrgang</th><th>Sportger√§t</th><th>Resultat</th>
</tr>
<tbody id="s3"></tbody>
<tr class="sum"><td colspan="4">Summe</td><td id="sum3">0</td></tr>
</table>
</div>

<div class="card">
<button onclick="send()">üì§ Meldung absenden</button>
<div class="small">Pflichtfelder: Name, Jahrgang, Sportger√§t, Resultat (f√ºr ausgef√ºllte Zeilen)</div>
</div>

</div>

<script>
const BACKEND =
"https://script.google.com/macros/s/AKfycbyg6E1LkZtDwROU2vUjSmyu7KPTYs5BQ4Q3wKYSefFICShMSkF2POow7bsewno5-1IJiA/exec";

function rows(tbody){
 for(let i=1;i<=5;i++){
  tbody.innerHTML+=`
  <tr>
   <td>${i}</td>
   <td><input></td>
   <td><input type="number"></td>
   <td><input></td>
   <td><input type="number" value="0" oninput="calc()"></td>
  </tr>`;
 }
}

rows(s1); rows(s2); rows(s3);

function calc(){
 [s1,sum1,s2,sum2,s3,sum3].forEach((x,i,a)=>{
  if(i%2===0){
   let t=0;
   x.querySelectorAll("tr").forEach(r=>{
    t+=Number(r.children[4].children[0].value||0);
   });
   a[i+1].innerText=t;
  }
 });
}

function pack(tbody){
 let arr=[];
 tbody.querySelectorAll("tr").forEach(r=>{
  const c=r.children;
  if(c[0]){
   if(c[1].children[0].value.trim())
    arr.push({
     name:c[1].children[0].value,
     jahrgang:c[2].children[0].value,
     geraet:c[3].children[0].value,
     resultat:c[4].children[0].value
    });
  }
 });
 return arr;
}

function send(){
 if(!g1.value){alert("Gruppe 1 fehlt");return;}
 const data={
  gruppe1:g1.value,
  gruppe2:g2.value,
  gruppe3:g3.value,
  g1:pack(s1),
  g2:pack(s2),
  g3:pack(s3)
 };
 fetch(BACKEND,{
  method:"POST",
  body:JSON.stringify(data)
 }).then(r=>r.text()).then(()=>{
  alert("‚úî Meldung gespeichert");
 });
}
</script>
</body>
</html>
