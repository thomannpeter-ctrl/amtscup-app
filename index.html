<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Amtscup â€“ Cup-Duell</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: system-ui, Arial, sans-serif;
  background: #eef2f7;
  margin: 0;
  padding: 1rem;
}
h1 {
  color: #1e3a8a;
}
.card {
  background: #ffffff;
  border-radius: 10px;
  padding: 1rem;
  margin-bottom: 1rem;
  box-shadow: 0 4px 10px rgba(0,0,0,0.08);
}
label {
  font-weight: 600;
  display: block;
  margin-top: .5rem;
}
select, input {
  width: 100%;
  padding: .4rem;
  margin-top: .2rem;
  border-radius: 6px;
  border: 1px solid #ccc;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: .5rem;
}
th, td {
  border: 1px solid #ddd;
  padding: .3rem;
  text-align: center;
}
tfoot td {
  font-weight: bold;
  background: #f3f4f6;
}
button {
  background: #2563eb;
  color: white;
  border: none;
  padding: .6rem;
  border-radius: 999px;
  width: 100%;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Amtscup â€“ Cup-Duell</h1>

<div class="card">
  <label>Gruppe 1</label>
  <select id="gruppe1"></select>

  <label>Gruppe 2</label>
  <select id="gruppe2"></select>
</div>

<div class="card">
  <h3>SchÃ¼tzen â€“ Gruppe 1</h3>
  <table>
    <thead>
      <tr><th>Name</th><th>Resultat</th></tr>
    </thead>
    <tbody id="g1"></tbody>
    <tfoot>
      <tr><td>Summe</td><td id="sum1">0</td></tr>
    </tfoot>
  </table>
</div>

<div class="card">
  <h3>SchÃ¼tzen â€“ Gruppe 2</h3>
  <table>
    <thead>
      <tr><th>Name</th><th>Resultat</th></tr>
    </thead>
    <tbody id="g2"></tbody>
    <tfoot>
      <tr><td>Summe</td><td id="sum2">0</td></tr>
    </tfoot>
  </table>
</div>

<div class="card">
  <button onclick="exportExcel()">ðŸ“„ Excel exportieren</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script>
/* -------------------------
   Feste Gruppen (KEIN 404)
-------------------------- */
const GROUPS = [
  "Arni FS â€“ Gruppe 1",
  "Sumiswald â€“ Elite",
  "Burgdorf â€“ Gruppe Rot"
];

/* -------------------------
   Hilfsfunktionen
-------------------------- */
function makeRows(tbody) {
  for (let i = 0; i < 5; i++) {
    const tr = document.createElement("tr");
    tr.innerHTML =
      '<td><input></td><td><input type="number"></td>';
    tbody.appendChild(tr);
  }
}

function calcSum(tbody) {
  let sum = 0;
  tbody.querySelectorAll("input[type=number]").forEach(i => {
    sum += parseInt(i.value) || 0;
  });
  return sum;
}

/* -------------------------
   Initialisierung
-------------------------- */
function init() {
  GROUPS.forEach(g => {
    const o1 = document.createElement("option");
    o1.textContent = g;
    gruppe1.appendChild(o1);

    const o2 = document.createElement("option");
    o2.textContent = g;
    gruppe2.appendChild(o2);
  });

  makeRows(g1);
  makeRows(g2);

  setInterval(() => {
    sum1.textContent = calcSum(g1);
    sum2.textContent = calcSum(g2);
  }, 300);
}

/* -------------------------
   Excel Export
-------------------------- */
function exportExcel() {
  const data = [
    ["Gruppe 1", gruppe1.value, calcSum(g1)],
    ["Gruppe 2", gruppe2.value, calcSum(g2)]
  ];
  const ws = XLSX.utils.aoa_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Amtscup");
  XLSX.writeFile(wb, "Amtscup_CupDuell.xlsx");
}

init();
</script>

</body>
</html>
